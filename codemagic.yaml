
workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 60
    environment:
      vars:
        CM_KEYSTORE: Encrypted(Z0FBQUFBQmV0VTBpeEJ2RTN2bjFCaFN1ZkRQWmVvdFpRT3RNT1h3Zk12XzkybGw5ME43ZWNlOFB4a19RdnF0M0R6YjJjU3hydDhDaEVLNU83Y3RlT0FVN1hwQnVPOFlMcG9RTjh6Qi1NSU1EX3JQc2l5dXRGSEpyaTZKUWczaXdFMXZySXNkeTZHQTB4X1JicWdOc0JNQUszZmIzTGJCM183WmMwbkdIaDdmWkg1Z01yd1hKdnFoUnNKR01BMThBMWJXRl9pekFZaGtpLUFhOFpCbHJrNE9rc0xFb2RDc2ZnM00xMi1vTk94SVNNOWdTUHA4RXpEZmNSZFhHSEc1SXRGSHloQVZHN2dVdU9JeU5UekJFTjBhY2d1NzdvVDBDVVJHWl9IbGM4aUlYOG9WaHY3VXJFNXQ1OVYwZDlFdVZxZE16VHR0c3dfSE12aVZCaDRkOGFTdVNVVzh5SWRpdGJGd2EwOFdadWt5V0xHdWF1MWtHWVNwMzNhaWRvbGlJbTdFbU0wdDBKc2lRd2ZtNVVBc1h2dmszdm45d0U4RHpMNFR1cFYzU01NY3o5bEtrb0tBV2hsR1YyVVM5ZnR4alJtb1V5a1N2WlYwbmZNZDc0RkdwUXhfOF9EQ3lFRjFkOEVJS2VLR0dMd05KOUkzWUx6RVhqdGtteFV2VTV5WWhkZFVhaXQtTi1SV2pVYlVaeWRwcldTbzhXUzA3TVdzZjI2SXRCdC1NLUxTUFBkTFdiZXpHdWNfa1otYkZ5aGhXTUpuclZacmU2cmlMYUFRNExTU3h4N1d6RDVTdXU2LU94WlQ4MzBOempjbnFMMmV3MVVOLW84WTBwQTFGcHBOdF95WDB6cG5BSzIzOXJZcXdtdWdRcG9NZTdBeEVqNWNyeVJjX2FXNXN2ZktEMEY3NG1YMTIwM0hXRUFtM0FaUXUzSl8yWkNQVm9LNm52NW85Y1YzeDJieThoQS13R3VvUkhkcUx5SF9QVk5rbEhtRWpwQXZ6eWh5THpHdXJLTEhOUGNIWHV4OTRqN3JXRWRRVVE3d2x5Znd6R1ZrdWJMbExOSG9GaHFOSHByVUlqWDdqeVRWVTBhVC1jS2dUMjBkUGdHVTYzRllPWFktS2Z5ZWhmTEtIaXhuSDhNQ1pRM1NXMHQ0N2F5cHdvN3VCeWtwWFNCWF9BLVZLTEVLZlVnS2F4S253b1pzOHd6V0N1QkEwVDZsaWJESjdNWWtERmJJN0RUZzdwWExKN1MtTC1MTXBRRmVtOTA0S2JnZE1neDQtSUU0WHdXaHJSdl9Hb0tRV21mQlhlZ3ItSnA2anowa1dYcnAzcjRnMjhtOGdpMm16c09pSGllVkJ3aTlFalhGa2J3WnFFTTF1Rm16aXVkS3NtQnJCd0MtNlNJOGlKMnVLODd0bWZhbTYwZHNael91R3Q5dFdoMVQ2ZENBc3pWSm1PN1p1YW16T1JsdzdIaWtVYjdHallnM0tRN01nd2F2Z3R5cEdWVnFFcS1pdVluQ0JJTEE1c1M1RDVVdE4teWdQbHp2ODU3OGFjZkFHbTNxY05vSjlYdmwzUWhvZFQyY0N6NnVXV3lrNVBOcmxvSjczMjRSNXE2T21FQ2NiUE0wcGl0T2FsbXNsSDFUaG9KUnNOT05PNjVJeHkteGV6a2l4elI4UXljWGhhcjBBSXlMUHZZUHo0eEtES1dNR3ZuYndYNGwtVW5SMU1lRnBYRXA0VkQyTDh2eHcxdGJlelhBbGk0aVVvakZnOEFENmppZ0U1cFlOOHNrX3RHS2tCVGljQkZfVkVtdGt2bnRXVUJ1RGE1bDV0Y01MM0o3RG9KVklTY2J5UXpPVGdPM0dXMmo3YldKbExrWVZQUGxLVzVfNUJoa1NzTVpKT3R3aDk2em9Md21Wd1lXUDVzRDFZRGhwUW5WME9qVkIxQTlmaFFTajc1OGlOUTZoeVMyQmVyVWloenVCajNFRS1hNGYyS0g3bnphS09DMFJoLVI5U05ZM2JoQ0RFN1pQQWduQ2VYSmt1VzQ5dDJwSUkyWGF1amNNdWszYkpUSHBtcVNyUENGY2Y2ZHE1c1Z1NkxsTkI1cGIwQi1EbERKbmplam5RMUJPTXFrV25FT2VSSmEwRGhkX0oyQmV3WlhSREFjOFhYbDRnQ0RZQmdES3FYWlZOMWswbnNoc016Z3NZaFdIMGhaNHh3bGN5NURuZU9EdjRKNGptdll6TDgyWC1qaTE0ekNTOGUyVHlSQmRQTmoxRjBsRXRFWThrM1hlWkF0dnBPbDZxN2xSLVI1MnZNLW42WDhHaTFwaVlrUWlIVjRIdmEwWExaT1ExN3JpVlJoZlg2ZThkbi1rYUZMTVctWExOTVlFMEo4aW9YS3lxRHlaOHg1d0NvbG5EVnZFejJna19xSkxvcWNPRl9DQXpha05zY1lxZS13Zks2WTVjUmcwMGhNdVFDb0VqamhoUHhwT0xHaTZGTmk0NnlXYTFFdzdUb1hVUVU4dk15ekw3UFJBWUs5OEhoX0NGeXlXM1hKVHNEZUtWMGw1OVFRRkw3ODRmXzBPS0tkOHUyLXRUSkNBbzJRSE5FQjZ3Rm9HVEVvZmhUazIzSnJubXBKd0QtZmU2TEU1a0RweElOR09hN2JJeUVaTHo5c0RWX2UyeFlsTUFDWTVSVk9UaVlsZ1RhLU1iYlpaRnFMcjE2eWRPa2ZNWjRfSmVNd015LXFmWEt1ai14WTVCc2RqYmRtZWZjcGlJR3Rnd3ViU3ZnMHBiZkVRcFQ1bE5hZFdERTJnREN0MkltdzFVaS12Y1lBMy1PUUxCR202VlFZQlJQNTZDZXN6MXdvYWxRN1QtZXFIa0pxSU5pVVJQN2pOWnZFRHFIQWJKUzJleDUwclR1MW9CRm5rSVNDdGt2bUxRM25vWG9uMEx3TS02V1dKb1VBOTNjMzdxdmI0UHNMS2RWSDF3UGwtTWVzdDMzTVg4ZmZpU1N0VFFCRmVQcm1hY3Z1S3ZvSy1xZTNWc04yc1pHSnQxdGRQaWRjcTRTTWxBTG13YXpiSU1aWkZqeFA2TkUtTHpNanhkRU9BUXJkeE45NmMyb1dyXzR2LVZDQzBaM0xzLWQ2Ni1CYWc3V1B2OTVOTGJwUFpSTlhwd0J2ZnNFTkJsaHRhM2ZiVkZlRTFMaUdCejVTS1dsRUdOaVV1cmFyTC1mTWRuMzdWUHVzQmVPX19kTURuWl9JSnJwLVk4b1h0Q0lmYUkzSjZnTllfTFJ2Vjhob0h2X2V6eTAyekRHcGk5eUV1WXZKR0laVFVrU0lSWUhzbTNPR1lxbXFyVklnZFhNblZfTVU4UG1mY1BWd0Y1NHdaMV8wUDJ0R2NocTkxTEJFV0tRcHZBZWlzcElPSnhCNl8waHVlTUcyc05xTTBtQ00xZGd2dmpVd2Vqc21KTjNpT3RNVUwyU29MUTA1MzdCRzBqTkdKY19yQTg4UG9ZRjhYZUNOdlZVdGhhbFRMYzMxNmRqeFNvbVFJdWVUMVFyMTkzaG9yNm03bTJQWkhUdkhRWW1EOG1qZ2dLN2Q0dVJqVU1FM0xoVG43VkdOMzRiWFlRZGx2R3c1S0pDajM0Snp5dnlqN2FTVy1DZ21kajU3b0hWSGZiYnF5Mnh0NWFGWTJIOG02VEZCcHl6eEZSMHRpalQxRVYwTGgwVU9FOTEtc3VmaUhLZEU2ajNWM2FmQUZGLXVZSmV6WHVua0dOQ2dFcHBGSGc1ZmxfTnBjeE5DV1daVmRXeWk1N0lqdlE5XzktVVp2bVg2MnlYb1kyQ2xzcU1IbmFySHlGT3lCMkNyeTdzaFZQcEhtZ2Z3bVhfamw1aDNMNTFONFpwT0JMWDFXN1RCelJFWlFOblpPUXc0TWVvTzFBeFhfN2pMTWZrU21keVAySEtTUFZOOE8tM3dmRks1YXAydE15dEQ3R0g4Sml2RlVSNEdUWHVQcG5IbU1kTS12NU5OS2g3RGZfVWJtdU1kVTZIM0tpZTdRMHVfaURRU2FOd0VDZmRzQkhkZm1VbUtNN2xobUZjVEg1S19GVHJodXl0eFJfbVBOY1JPaVprYmN6U0dDc1p5d0tnMGNzMFJoQUdFRjYtaTJtYmZ2VDUtZjEwR0lQdlNiNkp5UlltV0pxUVdOYXJtenRTNlFvbVJvenBYWlNJZGZlZTJ5TVFJM0YtR0NvYldVSHoxbGNxd1ptLUV4SS13Nlo4Rmt3OFVvNWN0aFZYdUdCUEJ3NVdUODJZWmNOTldtUjJETjVuMWJwRTktcWR6cHdzZjlXX3p5TGdxTVFla3huVUp1VW55cXduNEY0ZC0wclJxU1FqOWVoRFVfM3N3ODRJdzV6THF5dzdTNjJBbkVHcGxfREFzTVJ4bUh1NWpudDJJNjMtOWV1aEhveGZYOGpwdS1tTGR6V2JZUzN3aWRya1B2MVRsSmhWRFEtWFdfcFpiWjFOSTlJWmtFNkFOWkZyeHRydE90ZzhoMHdRUlBUVE5Bc3JBeDV3cWlzM25qcUZlZzFsNEtOTjNZTWVoNjR2aDRVaDg2LUQ2UjBjMUlqRVJVdkoyWXdVM3JVa0NLV3FHQ3habWU1VnJSeE9CdGVWOTdkVE9oNll5UU9yR0dHYVpBaTVvaG5uN1NleVRHVkJkaFhOTTFjNjBaUHc2bUtXckdGZkhQNUtVamdsVWpuQzkwRG9KT0J3OTJiUGJfZXA1d0JZMk9ZMXhzNzNXS1p0RFFrS044SmE2QXN4REVKTGItX2FLdkpuVVBhNXo4b3l3YzV5MWt5SnBhbWRXN2hGLVBvZkpXOE9qUGtacThXSzdzVEw4VFhDa0U2WTVUYTZCUEJMTjNJVUFMV21ZOEtBM1FuVnc3RERyaXU5a0VzTUEzV3o2T1l1TWxya1BCR1E0OEMtRi1uZHdWOXJzbTk4bFl2Y0JTY3Y3X3d5WUk5SXJNYml1YUJlcmxTLV93aUZzVnNaLWdrVEF4TTB6VlM3THNRTGxmWFJCeVZLdUFQcG1MUXRIMjVqSTNHdUJVNVV2bWo2OW1DeV9lQVdVOWJCLUhIYmxkSmpFSDFnM0tMWnJTX1NLcnJGbDd3LS1aUlRKdmxna1dFSmxlZHBwdjQyRlNoS3VFUHJEdEYzNVdmcEdqLTdRV2VIUW1uS0JfYmV1Y2s2QUdpTWR5ajdQTHF2N0tkNGFpNVJ4LUx1TGRaVkJ0cHJ5dl95WnBlRHZENjNoZldfaXNWYVNCX18yUmhyMUVzMkc4ODV3aFlZcGFrajU5X0dHdXVKbHoxb0p4Sl9wMVRRaDRxX01pTmxicUhJWWZEaTVWeXlISFFCYTBUeVByNjF6T2NqZ3Y1enpjVUdEYnBKSl90ZFpGclNvVzU5QXJCNG56NnRCZUdUbWg4M01MQl9PUEpjVnZwbTdPV3MwakJxS0JTNm1pRTY1RW13MVdNVHdsWWhWUVV0TT0=)
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmV0VTBpMlV6dHhoUmRGR1oyR1V4U0ZabTA0SGhxS0Ntc2dweHA0YnpmZUU3SFoyN2dja2lNRnFGZlg1dXQxU1BaY1F5Rm1NYWVfVTdwUkd3SVc3aDVNTHFPV2c9PQ==)
        CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmV0VTBpbWp6VzRWcndhdmdfV2djRUl3NHBSWDQ0NGZCVGVaOUl3bHRDOERseHM1RGxoZThfM25EbFdhMWNFaWVmVnJkdDFfRi1iOGpfUERjVnpBQzdpWDlOMWc9PQ==)
        CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmV0VTBpS0hBM0d6czhyNmVrbjlUV3NwM1BKNUU0RmJBRm9FZkwzRTBDTTlxOHR5Y21HT2otQjljalNOQkVOaXNsenpwenZVS2ZsWVR3M3U2VFZTWVhUbHhTNEE9PQ==)
      flutter: stable
      xcode: latest
      cocoapods: default
    cache:
      cache_paths: []
    triggering:
      events:
        - push
        - pull_request
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
    scripts:
      - |
        # set up key.properties
        echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$CM_KEYSTORE_PASSWORD
        keyPassword=$CM_KEY_ALIAS_PASSWORD
        keyAlias=$CM_KEY_ALIAS_USERNAME
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - flutter test
      - flutter build appbundle --release
      - |
        # generate signed universal apk with user specified keys
        universal-apk generate \
          --ks /tmp/keystore.keystore \
          --ks-pass $CM_KEYSTORE_PASSWORD \
          --ks-key-alias $CM_KEY_ALIAS_USERNAME \
          --key-pass $CM_KEY_ALIAS_PASSWORD \
          --pattern 'build/**/outputs/**/*.aab'
      - find . -name "Podfile" -execdir pod install \;
      - flutter build ios --release --no-codesign
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      slack:
        channel: '#flutter_build'
        notify_on_build_start: true
      email:
        recipients:
          - ezeugwagerrard@gmail.com
  android-workflow:
    name: Android Workflow
    max_build_duration: 60
    environment:
      vars:
        CM_KEYSTORE: Encrypted(Z0FBQUFBQmV0VTBpWFBwUmt4VjZuWjNnODluZVpCYU9PdG1fRzk4eXFSN005dWUtMWxDOGx5TS1MNDl6SHM1RjRQWVdURm42UWNwQnZBODhxOVB1U29ZSDJCVkFGX2NwTEdBczg1UmhURllzU0hvbE9CMzJweDI2bTEyVHFPNUtTS1J1dHViempwcEdjSTFSVU45Z29mN3dkcUNxclJ0MmNmV09VM2F5aHk1bjhfbzJtSkhwRmhvejlrX2ZuQWJYbExlTzFLc0JuM0VUcUNrUHkzWGF4V1VkR3d5TW9wcWVYbDRRQ1F0WVBxNWg4N1NMQmNLanlvemhxaE1DVUJLTlk4ZEs3eV9KSUtGV3A4SnE0NzZtUnUwZlRNZm95X3g4bm1ULWY3SEdQZHVrVnNzWXpOT19CZnhPUFQzVEt3cWRCNTR6YjB1OTBDNkZFTWVhdVZuT3F2V2k3dHN6bmhtdG1iY3VJMnpNVmhJT3RlZWYtcU1GM0FsYVJCYUdadVZKQ2hEQmVjaVh6Q0lXZjlHdzZGb2pUQUxueWV2S2tXUGk2TTNwMjlLM2JrTkZFTU9oRVdvMVFLN1hYOURDSzZiQWEzemFfdnB5SkJWMHBSM0RBY1V2cF91S3BBdzZ5VzhUSzJvN2lZV1dqeHN1N0hKTldVdHRyenBFeUt0M0VTMlZaT2lGS2Q5ZWROZTlfWEZRWjBfX1ZjNkZNWklSY2FCQjdwdlowMUJuRFgwVEQ1TmlkME5iekdSUFhXc2txZ0FMNHlERkR3Mnc4OG50N0Vka2ZVcDdnUmJ0a1F1R2pSdm9CMlUwSnB0VlFtM3BQUjFxWUp5YVI5VVlJb1hlX3lVeDhBUXhJc2kwSzdvMlFPblFoQnFsQnpXc2pWTkZJYnZDbW1tZm1ya041V1NmZGZ3ZnA1RGloV2hCRE5ub1VRMHRkOHhtTEVOcFdxSDBsSmlNLURRd2hLOUxPTUZPUFNjeVk5SHluUUFuYWhXc3NCbUMtQXRmbXgxSnowak5kYjdIZ29sNWhmSkkwbElaS3VJMTdiRkM5dXVITnJkNUFXUDJ0SERMcFExTko1TE9SZi16Rk9pV3QwVmw5bG5wNWRFd3lpQkFETXRCVzdsZ0dJRW9zTTh5LXdWNG5DXzA4QzhRVnZISjlEZHZHaUotVmhORi1WVmVrZlVWSXlxSkRhT003MjlDX3RBQjJwVzNvb1pXaDZ4T0c1MDVGa2hJcWN4N1lRbEJGX0ZWOUpnVnQ1U05lV0FzMWprOE9QSC1jTHRXM2JBTHdvX2pxRzlZb21FYkxTcDVzdEZJU2VrYWhBWU9qMldlNm95WkRrdnNyNmNnQWFrcjlqTkRDRzgyZzNkaDZvTnJmMXdqNWJWNS1EMEtmWW9FalJaVDNpc3g2MG5FUUFaRDM3WUNIT3FYYUJ0TERvV0tsOWZCN3VyZGJhTUdrNWRuRXBYenJxV3dHSkZJYlItSmJ6XzZUR2xBVW5BT2R4cHk5SGEtQVBxcm14STFjaHF5empKWmo1dnFDaW1FOENmLTR6bm9lVlJHTmJqdUhUMk81NTljQUs4Ym55bUgzWmJfdG1ZWHdaZmVCUTR0M2lJMnVxMmY3VDR3NXZuQ280bjFmcXRLMlB1UHZIVHhpejczVVNTTVl0aFhlN2JRN1RsVDdGVEFXOEZodmxoTzlxdktDTml4VEttMUlPam1tQUd4TnQ1dDZJSUtUbTduTWZJM3RNeVNIeUdiU0gxbHJJMktTTHZobllwbVNGTFEtRk9UdFNtSFZtY2pxMGxmckJvdU50aUlSUkN0WmRydmFicno3Sm40S3BTUms0dmRBZURQeU96cTdVZkJuYm9zR3BKWXhlalY2UTRfcEladXBGXzktYXNzTjV0eVBYRThPcWxtMGhjbE9oTUhQcjhRckt6MXdGQnFMYWVXOW1RMHlGT0U0WElHRGJZMFEtbjEtUGVaMC1jYWZDX3JOUjVRUkxSZjUwdmtHVlNzUmU0VGpGTXJkOXEwbnBwUjlxXzhLdlh2cXJjRDJQSV9Fb3VXUlpWVFNIeTBOdXQzTFpmQS1lQnMwallnT0p1WEd5bmhQdlBaMm1YV2xLR2Zja1U5T0tRQk1UZ1JKQnJmV19MUmpqczlWbGtsRmFQZmlQSkpwM1pDUTMtanBQaEtPc3ZYZFFoaUhoUFVZN3A1ZF85LUV4M1A2cnhGS0s4R0dSTE5MR1pxSWFFbkptNHE2cmVkSzRRZnpQaEwwN3djVWpJcVUyc1ZOcWtHcHZRX0VuNm10SF9LNVZEaHUtTzctUjFrTlJMaUxlMzNzcTFUVzdIN3RKcG1YVDh3TWZUUFFVUzVJNVkwVi1veVYyRF9JcTJhQkNya2ZkSk53dm9WYnhTYm5iRGRSZ0xGRkRyYWZDSmJYSllaaW1EbzZ5T1BjRXBVY1Y5R05iTFVZbWZMancwVVJmLUNQOWtCUWFOektOVGhHc3dCN0czZGJzX2V1QThucUFIMmptVEpEcTVEQ0RvYU8yMDl3WWtVcnFJNm50TmNuNWJ0MjQ1dnJHaWt3UnJiaTgySTFyTFM5bWhLU2RjREMwWjE0MVBZRERWN19fU0JyLWdRUmpsdThxWkhQemltSUdDUUJaNmxWRHJCbVctYjNuc2RZb2NSZFFOS0xFVGhFb0VHVzlaZzVfN0p0WExDSFZsdGRGMElDck9JcmZjLVJyTTg1YW1vYm54TzRsZGRfbXhFeEhGYjZTSXdScEluVW93WVBRUXBPTHVUMDJWbHlWWVpBZFVlb09OMXY0OGFsdUp5bDJEY0taUFJkSVBwUHFWYnhiYWRTX2ZnUzZqTWxlemJHU0NsajVoVGxOT1lCTXBtaGQ4RE8yTlJnWUJzNlpKdUU1bU52TmZ5X3JqVHNhV1RWX3FKVWVrTXFWQU15WHp6WURBQlhwLUM1Q0o4RGF6SWg0UDY0aFpFNElpaWFkWHBhb3ZCZER5SDI5dGEySGRPc0kyVDdQQk9uWWVGdnhmUEZoQnFSOHZpakx1SUsxU09zMHRoZTRFS21YbFFjWS00NjdxTmNHcEU0eldib0dwaTQxTGFKaWp4SnBMdGdkeXZYYkdUOS1EempoYTJZOGdObTZXWmhEbWNfbFFQUkZsN2l5TjBnZjlBa0dqOTRNOU94M3RzUHdLOW5aREEyLWlHVkxfRHE3N0hHOHFmS0VwcE5DZTgtQTRTTWtrVDczNkIwNmltTWRIaDZZc3V5dFAyVnRQRVplNWhDQmVfck83b2NWZGd4d2wxcUJxbktzLUtEQmV1REdJelFad0lpRk1vR19Qa1N1Nk5LVWpSZnp0OV9KT0QtcUZKQUpYY0FPMzJfaDhWTDM3ZUowdkdueDVTWkdnV3BnNE5DX0lJRkU0YjdNSVBZOEM4MHdzS2lUQk0zVVlIR19BMllSY05WYmg3czJCRzctWlJSY01qQnhiR0lqWXV2cGM2amh4SEtfcHlVWGQtYm93UkhzcGlWd2tVWjhqMXFsVW5FY1c5QjNJQlhaV3NJcEFFYkxwZVhCTjlHdmFKMHh6SUwtZWZJUDlfM2l4d0hzNm9LVWVuRUdqeGplMmtyR3M2TUc4Y29hVVR5MVpVT2FwZDZZalhwdU13UkFlbmVvajRmT1RLRXB5MnRMeG9BSG8xV1RsblZlbXB5aHBrcUhpcHVrUHJpcEJ0T0E2V3NLdzdLcTVicEZKTWFiWU5EWFE2U2ZqMS1NbWZZRnBJUlNkVFpHamh1d1pjdDZsaGNhYV8tRF9jSEt0M19MeTJQODRlV3ZNVmlrOFZPRmJMRnhQLUhkVWljTDNmNEpSNjBHczFGWFdUSnFPVkdETUJFaEFaRkVZLXVoQm9uTG9aZlhPejRzX2xQNlA1VHRpSklPQnhKU2otMUtCeS1fVWNZMEZaa19tMDlJTDJHUU1oeXFTSTk3aWVNc2FkenBNbi1hbjRVTTZMWEZPelRtVDZHX3JvMjNjcWxMeW9UMG45eG5lbVVTSDdVMTFRYWprOXBWTlc1MmpKdm9ob3FqaC04cnp0OXltYXdzUWJ4bGZ0d182c0llZXgyMVUxUzBnMDBGMDlNVHJvX19xcS1TU0FWY2FTVTMyMGxkOTBpbE5LLUc0dzM0R29yRWdhUnYxaURocElPRF9jU1EwUGJhNFp5YXhyUlpoVFlPcjdpc2JuVFJfQ2VNQkUzWVZVZ2NTZV9ZbXMyMkxxMHRBR2o0eXl6ak1GZl9HOC1GWU5XWVlEN1NRYTZMWTN0bWI0X25pU2Y2M0pWWU5jMXZyVFZoam5USWgwWnBLTS02VVQwZEE3TzFrTThyTFk2VW95aTdpcUQxTHdlano0dnE4UnVnQ056alRIS1JpU1FIWGZNekdualE1UFhJRnU4bkg4Q29UVXFmN0VzRklUbnBPdkdSTHJFS2RvOVZzVE1QamdRTDVJdVF5cmxoLXMxeGk5aktCNER1UzB4d3FDZHJNcnc4S3pTNlY4dHI0dHBGVmlDSS05U0ExSERPRjVNb1FSU1BrX3lBeHk4Ul9iZjBfMzBzdXB4YWthb1J3LTFOVDlCMlBjNjFDQ2RRdXk2OTdQZDVvbmlRRmJTZUI5bWVyemRfVzdXeWhYVFdoY1oxYUg3OTM5eUJUYmhMMUVjYm5tY3ZtSzVndExsaWxyeUZad0t0U25MZWJZNk9OX0RfbUFSbUJrUHBqLWxkbDQ0dEhBb21TQmhqM3pCOGNBR3I4b1VQRW4zZC1ZN1Nwa0lNYWZ6ZWhqVTBOQ0VKQlBhR1o5b1B6dWU5d21tUVMyZm9TOHVMR1dQR3JEbzhFTFRxSk44c1p2b1dIdEpjOUVoZUEyeG5LbFVhNkp4WUs0R2VJeUhoWmZXN1pWZFVSVUNOWndfM0kyXzBuekY4WDFVVTktRGNfNW1mZk9PcGJjc0hjakxsX2Z0bEpPbnBNZnpRX0dFMFBuek80N3ZRRVBocF9QT1ltbVFIZXRvS0ZpamJlTWhnWER3dlJOaUdXc3ZCUEZLSnFYN0Q4TXg5czdrRzZORWF5SzN6OWZjTkg2bGswUW5VcU82LU1rLXI3QUc4elV2aFN6TGRpVlJfZDBSMXVhQW5GU0k1cmhNNXViSmdQcXNva2pjdl9yNi1oS2pVT0V1VTNZZlFfWnhhOWRQbmpYTldiTl9zRmwxZUQyWGdzRkhSU1RCZnN6Wkdjc05zbzU0MUVaUEFBbDk2R01ZWnNUaS1hWmtuT3RxRHlFbTRzdHdTZTJ2YWU2Ymc3VHBIb0lNNDZveEtLVDIydlhVVi1LZXF0LUdDR2FVa0t3U25kM0dwOVMzbWxGcTZBV2xGd1Q3dFZBejZlOW5TWDZQSTFNSEFZSU4xRWtaUnRZUDl1QzdDMko5YVlTUXN6dTR3Y096UC0wLTBuUHJHaHlPbDRUb0Q5bVpUdm4xZGV5cXUwUWxCdz0=)
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmV0VTBpTUllMHVreXplRWRYc3JWeG8zOUFPN0g5R0lLbDlyVDZmSTlrbDc4R3NhVDZsZ09pMVo5NlBiOUJ3ajFQdUJfLWpTMDUycENzYXltWGk4Q0Zqd2tOZFE9PQ==)
        CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmV0VTBpVTNxY2ZLQjR3TWhWb0I3N0xJT0FpRUdJZEJmT1R3ZkxIN2lPSGprVkM1MnBnZ0gxdDFhWjJMajktRUR0XzFwQ1Y0eEZpQ29xZWd3MWcxVEs3VnpLZ2c9PQ==)
        CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmV0VTBpLW1yMm5MSDFGWllBbmh4R0dWek4wUExMT1FGaUhtZUh1am45WnBWbmxyUEktd2NlcE9sMWY1alNxZWdLTzQwRlVTcFlSa1VwUDNkdVVpUnJsd0txLXc9PQ==)
      flutter: stable
      xcode: latest
      cocoapods: default
    cache:
      cache_paths: []
    triggering:
      events:
        - push
        - pull_request
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
    scripts:
      - |
        # set up key.properties
        echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$CM_KEYSTORE_PASSWORD
        keyPassword=$CM_KEY_ALIAS_PASSWORD
        keyAlias=$CM_KEY_ALIAS_USERNAME
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - flutter test
      - flutter build appbundle --release
      - |
        # generate signed universal apk with user specified keys
        universal-apk generate \
          --ks /tmp/keystore.keystore \
          --ks-pass $CM_KEYSTORE_PASSWORD \
          --ks-key-alias $CM_KEY_ALIAS_USERNAME \
          --key-pass $CM_KEY_ALIAS_PASSWORD \
          --pattern 'build/**/outputs/**/*.aab'
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      slack:
        channel: '#flutter_build'
        notify_on_build_start: true
      email:
        recipients:
          - ezeugwagerrard@gmail.com
  ios-workflow:
    name: IOS Workflow
    max_build_duration: 60
    environment:
      flutter: stable
      xcode: latest
      cocoapods: default
    cache:
      cache_paths: []
    triggering:
      events:
        - push
        - pull_request
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
    scripts:
      - flutter packages pub get
      - flutter test
      - find . -name "Podfile" -execdir pod install \;
      - flutter build ios --release --no-codesign
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      slack:
        channel: '#flutter_build'
        notify_on_build_start: true
      email:
        recipients:
          - ezeugwagerrard@gmail.com
